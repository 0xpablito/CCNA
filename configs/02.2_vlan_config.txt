! #######################################################
! PHASE 2.2 : ROUTAGE ZONE OPÉRATIONNELLE (GAUCHE)
! Appliquée sur : Routeur Central et Switch Accès Ops
! #######################################################

! --- 1. CONFIGURATION DU ROUTEUR (ROUTER-ON-A-STICK) ---

interface GigabitEthernet 0/0/1
 description LINK TO SWITCH OPS
 no shutdown                       ! L'interface physique doit être active

! Sous-interface pour le VLAN 70 (Partners)
interface GigabitEthernet 0/0/1.70
 description GATEWAY_PARTNERS
 encapsulation dot1Q 70            ! Tagging VLAN 70
 ip address 172.16.70.1 255.255.255.0

! Sous-interface pour le VLAN 80 (Logistics)
interface GigabitEthernet 0/0/1.80
 description GATEWAY_LOGISTICS
 encapsulation dot1Q 80            ! Tagging VLAN 80
 ip address 172.16.80.1 255.255.255.0

! Sous-interface pour le VLAN Natif
interface GigabitEthernet 0/0/1.99
 description NATIVE_VLAN
 encapsulation dot1Q 99 native     ! Gère le trafic non-tagué du switch
 ! (Pas d'IP nécessaire ici)

! --- ROUTAGE DE RETOUR VERS LE SIÈGE ---
! Indique au routeur comment atteindre les réseaux 192.168.x.x
! On utilise un masque réduit (summary) pour englober les VLANs 10, 20, 30, 40
ip route 192.168.0.0 255.255.0.0 10.0.0.2

! --- 2. CONFIGURATION DU SWITCH ACCÈS (GAUCHE) ---

vlan 70
 name PARTNERS
vlan 80
 name LOGISTICS
vlan 99
 name NATIVE_VLAN
vlan 999
 name UNUSED

! Configuration du Trunk vers le Routeur
interface GigabitEthernet g0/1
 description UPLINK_TO_ROUTER
 switchport mode trunk             
 switchport trunk native vlan 99    ! Doit matcher le 'native' du routeur
 switchport trunk allowed vlan 70,80,99

! Configuration des ports d'accès (Utilisateurs)
interface range FastEthernet 0/1 - 10
 description ACCESS_PARTNERS
 switchport mode access
 switchport access vlan 70
 spanning-tree portfast            ! Connectivité immédiate pour les PC
 spanning-tree bpduguard enable     ! Sécurité contre les switchs pirates

! Sécurisation des ports inutilisés
interface range FastEthernet 0/11 - 24, GigabitEthernet g0/2
 description UNUSED_DISABLED
 switchport access vlan 999
 shutdown
